{% extends "base.html" %}

{% block title %}Football{% endblock %}

{% block content %}
<div class="post-title">
    <h1 class="display-4">Football</h1>
</div>
<img class="post-image" src="/static/images/football.jpg" alt="Football">
<div class="post-text">
    <p>Let other fans know what you're thinking, post a post on your chosen football memory below.</p>
</div>
<form method="POST" class="post-form">
  <div class="post-inputs">
      <textarea name="post" id="post" class="form-control post-textarea"></textarea>
      <button type="submit" class="my-form-button">Add Post</button>
  </div>
  <input type="hidden" name="sport" value="football">
</form>
<ul class="list-group" id="posts">
  {% for post in posts|reverse %}
    <li id="post-{{post.id}}" class="list-group-item post-item" data-postDate="{{ post.date.strftime('%Y-%m-%dT%H:%M:%SZ') }}">
        <div class="post-header">
            <span class="post-username">{{ post.user.username }}</span>
        </div>
        <div class="post-content">
            {{ post.data }}
        </div>
        <div class="post-time" data-postdate="{{ post.date.strftime('%Y-%m-%dT%H:%M:%SZ') }}">
        </div>
        <div class="post-actions">
            {% if post.user_id == current_user.id %}
            <button type="button" class="my-form-button" onclick="showEditPostForm('{{ post.id }}')">Edit</button>
            <button type="button" class="my-form-button" onclick="showConfirmDelete('{{ post.id }}')">Delete</button>
            {% endif %}
            <button type="button" class="my-form-button" onclick="toggleCommentForm('{{ post.id }}')">Comment</button>
        </div>
        <div id="edit-post-form-{{ post.id }}" class="edit-post-form" style="display: none;">
          <form onsubmit="event.preventDefault(); saveEditedPost('{{ post.id }}');">
              <div class="post-input-wrapper"> 
                  <textarea name="text" class="post-edit-textarea">{{ post.data }}</textarea>
                  <div class="post-form-buttons">
                      <button type="submit" class="my-form-button">Save</button>
                      <button type="button" class="my-form-button" onclick="hideEditPostForm('{{ post.id }}')">Cancel</button>
                  </div>
              </div>
          </form>
      </div>
        {% if post.comments|length > 0 %}
        <div class="comments-section">
            <div class="comments-header">Comments</div>
            <ul class="list-group">
                {% for comment in post.comments|reverse %}
                <li class="list-group-item" id="comment-{{ comment.id }}" data-commentDate="{{ comment.date.strftime('%Y-%m-%dT%H:%M:%SZ') }}">
                    <div class="comment-header">
                        <span class="comment-username">{{ comment.user.username }}</span>
                    </div>
                    <div class="comment-content">
                        {{ comment.content }}
                    </div>
                    <div class="comment-time" data-commentdate="{{ comment.date.strftime('%Y-%m-%dT%H:%M:%SZ') }}">
                    </div>
                    {% if comment.user == current_user %}
                    <div class="comment-actions">
                        <button class="my-form-button" onclick="showCommentConfirmDelete('{{ comment.id }}')">Delete</button>
                    </div>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        <div id="comment-form-{{ post.id }}" class="comment-form" sport="football" style="display: none;">
          <form method="POST" action="{{ url_for('views.add_comment', sport='football', post_id=post.id) }}">
              <div class="comment-input-wrapper">
                  <textarea name="content" placeholder="Add a comment..."></textarea>
                  <div class="comment-form-buttons">
                      <button class="my-form-button" type="submit">Submit</button>
                      <button type="button" class="my-form-button" onclick="toggleCommentForm('{{ post.id }}')">Cancel</button>
                  </div>
              </div>
          </form>
      </div>
    </li>
    {% endfor %}
</ul>
<div class="modal fade" id="confirm-modal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="confirmModalLabel">Confirm Delete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this post?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary my-form-button" data-bs-dismiss="modal">Cancel</button>
          <button id="confirm-delete-button" type="button" class="btn btn-danger my-form-button">Delete</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal" tabindex="-1" id="confirm-comment-delete-modal">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirm Deletion</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this comment?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary my-form-button" data-bs-dismiss="modal">Cancel</button>
          <button type="button" id="confirm-comment-delete-button" class="btn btn-danger my-form-button">Delete</button>
        </div>
      </div>
    </div>
  </div>
  
{% endblock %}

{% block javascript %}
<script src="{{ url_for('static', filename='script.js') }}"></script>
{% endblock %}
